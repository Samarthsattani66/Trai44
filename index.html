<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Live TV â€¢ Premium IPTV</title>

<script src="https://cdn.tailwindcss.com"></script>

<style>
body {
  background:#0b1220;
  font-family: Inter, system-ui, Arial, sans-serif;
}
.card img {
  transition: transform .3s ease;
}
.card:hover img {
  transform: scale(1.06);
}
.section-title {
  font-size: 1.15rem;
  font-weight: 600;
  color: #e5e7eb;
}
.scroll-row {
  display: flex;
  gap: 14px;
  overflow-x: auto;
  scroll-snap-type: x mandatory;
}
.scroll-row::-webkit-scrollbar {
  display: none;
}
.card {
  scroll-snap-align: start;
}
@media (min-width: 768px) {
  .scroll-row {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
    overflow: visible;
  }
}
</style>
</head>

<body>

<!-- HEADER -->
<header class="sticky top-0 z-50 bg-[#0b1220] px-4 py-3 border-b border-slate-800">
  <h1 class="text-xl font-semibold text-white mb-2">
    Live TV
  </h1>

  <input
    id="search"
    type="text"
    placeholder="Search channels..."
    class="w-full bg-slate-800 text-white px-4 py-2 rounded-lg outline-none focus:ring-2 focus:ring-blue-500"
  />
</header>

<!-- CONTENT -->
<main id="content" class="space-y-10 py-6"></main>

<script>
const M3U_URL = "https://allinonereborn.xyz/playlist/vip.m3u";
const EXTERNAL_PLAYER = "https://teamrom3u8plyr2.pages.dev/?url=";

const content = document.getElementById("content");
const searchInput = document.getElementById("search");

let channels = [];

/* FETCH */
fetch(M3U_URL)
  .then(r => r.text())
  .then(parseM3U);

/* PARSE */
function parseM3U(data) {
  const lines = data.split("\n");
  let ch = {};

  lines.forEach(line => {
    line = line.trim();

    if (line.startsWith("#EXTINF")) {
      ch = {};
      ch.title = line.split(",").pop();

      const logo = line.match(/tvg-logo="(.*?)"/);
      ch.logo = logo ? logo[1] : "";

      const group = line.match(/group-title="(.*?)"/);
      ch.group = group ? group[1].toLowerCase() : "";
    }

    if (line && !line.startsWith("#")) {
      ch.url = line;
      ch.section = detectSection(ch.group, ch.title);
      if (ch.logo) channels.push(ch);
    }
  });

  renderSections(channels);
}

/* SECTION RULES */
function detectSection(group, title) {
  title = title.toLowerCase();

  if (group.includes("cricket") || title.includes("cricket")) return "Cricket";
  if (group.includes("sport")) return "Sports";
  if (group.includes("india")) return "Indian TV";
  if (group.includes("movie")) return "Movies";
  if (group.includes("news")) return "News";
  if (group.includes("kids")) return "Kids";
  if (group.includes("music")) return "Music";
  if (group.includes("uk") || group.includes("usa")) return "International";

  return "Other";
}

/* RENDER SECTIONS */
function renderSections(list) {
  const sections = [
    "Cricket","Sports","Indian TV","Movies",
    "News","Kids","Music","International","Other"
  ];

  content.innerHTML = "";

  sections.forEach(sec => {
    const items = list.filter(ch => ch.section === sec);
    if (!items.length) return;

    const section = document.createElement("section");
    section.innerHTML = `
      <div class="px-4 mb-3 section-title">${sec}</div>
      <div class="px-4 scroll-row">
        ${items.map(cardHTML).join("")}
      </div>
    `;
    content.appendChild(section);
  });
}

/* SEARCH */
searchInput.addEventListener("input", () => {
  const q = searchInput.value.toLowerCase();
  if (!q) return renderSections(channels);

  renderSections(
    channels.filter(ch => ch.title.toLowerCase().includes(q))
  );
});

/* CARD */
function cardHTML(ch) {
  return `
    <a href="${EXTERNAL_PLAYER + encodeURIComponent(ch.url)}"
       target="_blank"
       class="card min-w-[140px] md:min-w-0 block">
      <div class="rounded-xl overflow-hidden bg-slate-800 shadow-md">
        <img src="${ch.logo}"
          class="w-full h-36 object-cover bg-black">
      </div>
      <p class="mt-2 text-sm text-slate-100 truncate">${ch.title}</p>
    </a>
  `;
}
</script>

</body>
</html>
