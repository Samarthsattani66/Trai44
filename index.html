<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JW Player</title>
    <script src="https://content.jwplatform.com/libraries/SAHhwvZq.js"></script>
    <style>
        html, body {
            font-family: Arial, sans-serif;
            margin: 0;
            background-color: black;
            padding: 0;
            height: 100%;
            width: 100%;
            overflow: hidden;
        }
        .jwplayer {
            position: absolute !important;
        }
        .jwplayer.jw-flag-aspect-mode {
            min-height: 100%;
            max-height: 100%;
        }
        #jwplayer-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        .loader {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
        }
        .absolute { position: absolute; }
        .inline-block { display: inline-block; }
        .w-2 { width: 0.5em; }
        .dash {
            animation: dashArray 2s ease-in-out infinite, dashOffset 2s linear infinite;
        }
        .spin {
            animation: spinDashArray 2s ease-in-out infinite,
                       spin 8s ease-in-out infinite,
                       dashOffset 2s linear infinite;
            transform-origin: center;
        }
        @keyframes dashArray {
            0% { stroke-dasharray: 0 1 359 0; }
            50% { stroke-dasharray: 0 359 1 0; }
            100% { stroke-dasharray: 359 1 0 0; }
        }
        @keyframes spinDashArray {
            0% { stroke-dasharray: 270 90; }
            50% { stroke-dasharray: 0 360; }
            100% { stroke-dasharray: 270 90; }
        }
        @keyframes dashOffset {
            0% { stroke-dashoffset: 365; }
            100% { stroke-dashoffset: 5; }
        }
        @keyframes spin {
            0% { rotate: 0deg; }
            12.5%, 25% { rotate: 270deg; }
            37.5%, 50% { rotate: 540deg; }
            62.5%, 75% { rotate: 810deg; }
            87.5%, 100% { rotate: 1080deg; }
        }
    </style>
</head>
<body>
    <!-- Loader -->
    <div class="loader">
        <!-- SVG animation unchanged -->
        <!-- ... (SVGs kept same as your original code) -->
    </div>

    <!-- JW Player Container -->
    <div id="jwplayer-container"></div>

    <script>
        function getUrlParameter(name) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(name);
        }

        let jsonData = null;

        async function fetchJsonData() {
            if (jsonData) return jsonData;

            const jsonUrl = 'https://binge-projects.vercel.app/API/sp2.json';

            try {
                const response = await fetch(jsonUrl);
                jsonData = await response.json();
                return jsonData;
            } catch (error) {
                console.error('Error fetching JSON data:', error);
                return null;
            }
        }

        async function playStream() {
            const id = getUrlParameter('id');
            if (!id) {
                console.error('No ID parameter found in the URL.');
                return;
            }

            const data = await fetchJsonData();
            if (!data) {
                console.error('Failed to fetch JSON data.');
                return;
            }

            const stream = data.find(item => item.id === id);
            if (!stream) {
                console.error(`No stream found for ID: ${id}`);
                return;
            }

            const player = jwplayer("jwplayer-container").setup({
                file: stream.file,
                width: "100%",
                height: "100%",
                autostart: true,
                stretching: "fit",
                primary: "html5",
                hlshtml: true,
            });

            player.on('ready', function() {
                document.querySelector('.loader').style.display = 'none';
                console.log('Player is ready');
            });

            player.on('error', function(event) {
                console.error('Player error:', event.message);
            });
        }

        playStream();
    </script>
</body>
</html>
