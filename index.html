<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Live TV â€¢ Premium IPTV Web</title>

<script src="https://cdn.tailwindcss.com"></script>

<style>
body {
  background: #0b1220;
  font-family: Inter, system-ui, Arial, sans-serif;
}
.card img {
  transition: transform .35s ease;
}
.card:hover img {
  transform: scale(1.08);
}
.card {
  transition: transform .25s ease;
}
.card:hover {
  transform: translateY(-4px);
}
.section-title {
  font-size: 1.3rem;
  font-weight: 600;
  color: #e5e7eb;
}
::-webkit-scrollbar {
  height: 6px;
}
::-webkit-scrollbar-thumb {
  background: #334155;
  border-radius: 10px;
}
</style>
</head>

<body>

<!-- HEADER -->
<header class="px-6 py-4 flex flex-col sm:flex-row gap-4 sm:items-center sm:justify-between">
  <h1 class="text-2xl font-semibold text-white tracking-wide">
    Live TV
  </h1>

  <input
    id="search"
    type="text"
    placeholder="Search channels..."
    class="w-full sm:w-80 bg-slate-800 text-white px-4 py-2 rounded-lg outline-none focus:ring-2 focus:ring-blue-500"
  />
</header>

<!-- CONTENT -->
<main id="content" class="space-y-12 pb-10"></main>

<script>
const M3U_URL = "https://allinonereborn.xyz/playlist/vip.m3u";
const EXTERNAL_PLAYER = "https://teamrom3u8plyr2.pages.dev/?url=";

const content = document.getElementById("content");
const searchInput = document.getElementById("search");

let channels = [];

/* FETCH M3U */
fetch(M3U_URL)
  .then(r => r.text())
  .then(parseM3U);

/* PARSE M3U */
function parseM3U(data) {
  const lines = data.split("\n");
  let ch = {};

  lines.forEach(line => {
    line = line.trim();

    if (line.startsWith("#EXTINF")) {
      ch = {};
      ch.title = line.split(",").pop();

      const logo = line.match(/tvg-logo="(.*?)"/);
      ch.logo = logo ? logo[1] : "";

      const group = line.match(/group-title="(.*?)"/);
      ch.group = group ? group[1].toLowerCase() : "";
    }

    if (line && !line.startsWith("#")) {
      ch.url = line;
      ch.section = detectSection(ch.group, ch.title);
      if (ch.logo) channels.push(ch);
    }
  });

  renderSections();
}

/* SECTION LOGIC (CLEAR & EDITABLE) */
function detectSection(group, title) {
  title = title.toLowerCase();

  if (group.includes("cricket") || title.includes("cricket"))
    return "Cricket";

  if (group.includes("sport"))
    return "Sports";

  if (group.includes("india") || title.includes("india"))
    return "Indian TV";

  if (group.includes("movie"))
    return "Movies";

  if (group.includes("news"))
    return "News";

  if (group.includes("kids") || title.includes("cartoon"))
    return "Kids";

  if (group.includes("music"))
    return "Music";

  if (group.includes("uk") || group.includes("usa") || group.includes("international"))
    return "International";

  return "Other";
}

/* RENDER ALL SECTIONS */
function renderSections() {
  const sections = [
    "Cricket",
    "Sports",
    "Indian TV",
    "Movies",
    "News",
    "Kids",
    "Music",
    "International",
    "Other"
  ];

  content.innerHTML = "";

  sections.forEach(sec => {
    const sectionChannels = channels.filter(ch => ch.section === sec);
    if (!sectionChannels.length) return;

    const section = document.createElement("section");
    section.innerHTML = `
      <div class="px-6 mb-3 section-title">${sec}</div>
      <div class="px-6 grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-6">
        ${sectionChannels.map(createCardHTML).join("")}
      </div>
    `;

    content.appendChild(section);
  });
}

/* SEARCH */
searchInput.addEventListener("input", () => {
  const q = searchInput.value.toLowerCase();
  content.innerHTML = "";

  const filtered = channels.filter(ch =>
    ch.title.toLowerCase().includes(q)
  );

  const section = document.createElement("section");
  section.innerHTML = `
    <div class="px-6 mb-3 section-title">Search Results</div>
    <div class="px-6 grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-6">
      ${filtered.map(createCardHTML).join("")}
    </div>
  `;
  content.appendChild(section);
});

/* CARD HTML */
function createCardHTML(ch) {
  return `
    <a href="${EXTERNAL_PLAYER + encodeURIComponent(ch.url)}"
       target="_blank"
       class="card block">
      <div class="rounded-xl overflow-hidden bg-slate-800 shadow-lg">
        <img src="${ch.logo}"
             class="w-full h-40 object-cover bg-black">
      </div>
      <p class="mt-2 text-sm text-slate-100 truncate">${ch.title}</p>
      <p class="text-xs text-slate-400">${ch.section}</p>
    </a>
  `;
}
</script>

</body>
</html>
